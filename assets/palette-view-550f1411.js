import{j as t,$ as h,i as R,J as w}from"./chakra-30b94965.js";import{u as b,a as y,c as A,s as v,R as E,b as N,r as i,E as x,d as T,M as D,e as k,f as P,g as H,p as I,h as L,i as M}from"./index-87a6d4fe.js";import{u as g,M as S}from"./index.esm-6fef172f.js";import{u as C,m as j,r as f}from"./react-326f1873.js";import{A as z}from"./ag-grid-d1cda0e4.js";import{u as B}from"./use-palette-4571f90c.js";function F(){const{t:s,i18n:r}=C(),n=g(),l=b(),o=j(),d=y(a=>a.app.selectedCountry),u=A.map(a=>[a.id,n(a.name)]).sort((a,e)=>a[1].localeCompare(e[1],r.languages[0])).reduce((a,e)=>e[0]==="UN"?a:{...a,[e[0]]:e[1]},{"":s("Please select...")}),p=[{type:"select",label:s("Country/Region"),value:d,options:u,disabledOptions:[""],onChange:a=>l(v(a))}],m=()=>{i.isStandaloneWindow()?o("/new"):i.openApp("rmg-palette-upload"),i.event(x.ADD_CITY,{})};return t.jsxs(E,{children:[t.jsx(N,{fields:p}),t.jsx(h,{ml:"auto",children:t.jsx(R,{variant:"solid",size:"sm",colorScheme:"primary",onClick:m,children:s("Add a city")})})]})}function G(s){const{city:r}=s,n=B(r),l=g();return t.jsx(h,{flexWrap:"wrap",sx:{"& .chakra-badge":{mb:1}},children:n.map(o=>t.jsx(T,{name:l(o.name),fg:o.fg||D.white,bg:o.colour},o.id))})}function W(){const{t:s,i18n:r}=C(),n=g(),l=k(),o=j(),d=y(e=>e.app.selectedCountry),u=P.filter(e=>e.country===d),p=f.useMemo(()=>[{headerName:s("City"),field:"name",valueFormatter:({value:e})=>n(e),comparator:(e,c)=>n(e).localeCompare(n(c),r.languages[0]),sortable:!0,sort:"asc",wrapText:!0},{headerName:s("Lines"),field:"id",cellRenderer:({value:e})=>t.jsx(G,{city:e}),flex:1,autoHeight:!0,resizable:!1},{headerName:s("Action"),field:"id",cellRenderer:({value:e})=>t.jsx(w,{size:"xs","aria-label":s("Edit city"),title:s("Edit city"),icon:t.jsx(S,{}),onClick:()=>a(e)}),resizable:!1,width:72}],[r.language]),m=f.useMemo(()=>({resizable:!0}),[]),a=async e=>{if(i.isStandaloneWindow()){const c=await H(e);c&&(l(I(c)),o("/new"))}else i.closeApp("rmg-palette-upload"),setTimeout(()=>{i.openApp("rmg-palette-upload","/rmg-palette/#/new?city="+e)},200);i.event(x.EDIT_CITY,{city:e})};return t.jsx(L,{children:t.jsx(z,{rowData:u,columnDefs:p,defaultColDef:m,getRowId:({data:e})=>e.id,headerHeight:36,rowHeight:36,suppressCellFocus:!0,suppressRowVirtualisation:!0,debug:!1})})}function $(){return t.jsxs(M,{children:[t.jsx(F,{}),t.jsx(W,{})]})}export{$ as default};
