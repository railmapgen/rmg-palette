import{j as t,F as X,_ as Y,f as A,a7 as Z,a8 as q,G as J,a1 as K,$ as Q}from"./chakra-uWiumq66.js";import{u as R,X as H,M as y,a as O,V as k,l as T,m as ee,b as te,r as P,E as S,g as ne,h as oe,Y as se,Z as ae}from"./index-xfkg7BKV.js";import{l as L,r as m,p as re}from"./react-CVMQYbqF.js";import{u as le}from"./use-palette-6PrrniSe.js";import{P as ce,R as w,i as ie}from"./pantone-input-SpKFsG0C.js";import{P as de}from"./pantone-checker-t35BrIgs.js";const ue=u=>{const n=u.toUpperCase().split("");return n.length===2?n.map(c=>((c.codePointAt(0)||0)+127397).toString(16).toUpperCase()):n.length===5?["1F3F4",...n.map(c=>((c.codePointAt(0)||0)+917536).toString(16).toUpperCase()),"E007F"]:[]},pe=u=>{const n=ue(u);return String.fromCodePoint(...n.map(c=>parseInt(c,16)))};function me(u){const{defaultValueId:n,onChange:c}=u,{i18n:i}=L(),{cityList:f}=R(e=>e.app),h=n?f.find(e=>e.id===n):void 0,a=e=>{var r,l;return(l=(r=i.languages.map(o=>e.name[o]).find(o=>o!==void 0))!=null?r:e.name.en)!=null?l:""},x=e=>{const r=e.country==="TW"&&["zh-Hans","zh-CN"].includes(i.languages[0]),l=i.languages.map(o=>e.name[o]).find(o=>o!==void 0);return t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"flag-emoji",children:r?"ðŸ´":pe(e.country)}),t.jsx("span",{children:l})]})},j=(e,r)=>Object.values(e.name).some(l=>l.toLowerCase().includes(r.toLowerCase())),d=f.slice().sort((e,r)=>e.id==="other"?1:r.id==="other"?-1:a(e).localeCompare(a(r),i.languages[0]));return t.jsx(H,{data:d,displayValue:a,displayHandler:x,predicate:j,defaultValue:h,onChange:e=>c==null?void 0:c(e.id)})}function ge(u){const{city:n,defaultValueId:c,onChange:i}=u,{i18n:f}=L(),h=le(n),a=c?h.find(e=>e.id===c):void 0,x=e=>{var r;return(r=f.languages.map(l=>e.name[l]).find(l=>l!==void 0))!=null?r:""},j=e=>{const r=x(e);return t.jsx(O,{name:r,fg:e.fg||y.white,bg:e.colour})},d=(e,r)=>Object.values(e.name).some(l=>l.includes(r));return t.jsx(H,{data:h,displayValue:x,displayHandler:j,predicate:d,defaultValue:a,onChange:e=>i==null?void 0:i(e.id,e.colour,e.fg||y.white,e.pantone)})}const D=u=>!!u.match(/^#[0-9a-fA-F]{6}$/),Ce={flexDirection:"column",flex:1,mx:2,overflowX:"hidden",overflowY:"scroll","& .chakra-badge":{fontSize:"1em",width:"fit-content",alignSelf:"center",m:1},"& > section:first-of-type":{p:1},"& > section:last-of-type":{w:"100%","& > div:last-of-type":{px:2},"& .rmg-section__header button":{ml:"auto"}}};function fe(u){const{defaultTheme:n,sessionId:c,onSubmit:i,onClose:f,onClearHistory:h}=u,{t:a}=L(),{recentlyUsed:x,pantoneReady:j}=R(s=>s.app),[d,e]=m.useState(n==null?void 0:n[0]),[r,l]=m.useState(n==null?void 0:n[1]),[o,p]=m.useState((n==null?void 0:n[2])||"#AAAAAA"),[g,C]=m.useState((n==null?void 0:n[3])||y.white),[M,b]=m.useState(""),[v,F]=m.useState("color"),I=()=>{b(""),F(s=>s==="pantone"?"color":s)};m.useEffect(()=>{c&&n&&(e(n[0]),l(n[1]),p(n[2]),C(n[3]),I())},[c,n==null?void 0:n.toString()]);const B=[{label:a("Select"),value:"color"},{label:a("RGB"),value:"text"},{label:a("PantoneÂ®"),value:"pantone",disabled:!j}],$=[{label:a("Black"),value:y.black},{label:a("White"),value:y.white}],z=[{type:"custom",label:a("City"),component:t.jsx(me,{defaultValueId:d,onChange:s=>{e(s),l(void 0),p("#AAAAAA"),C(y.white)}})},{type:"custom",label:a("Line"),component:t.jsx(ge,{city:d,defaultValueId:r,onChange:(s,E,G,_)=>{l(s),p(E),C(G),_&&b(_)}})}],N=[{type:"custom",label:a("Input mode"),component:t.jsx(k,{selections:B,defaultValue:v,onChange:s=>F(s)})},{type:"custom",label:a("PantoneÂ® code"),component:t.jsx(ce,{value:M,onChange:(s,E)=>{e("other"),l("other"),p(E),b(s)}}),hidden:v!=="pantone"},{type:"input",label:a("Background colour"),variant:v==="pantone"?"color":v,value:o,placeholder:"#F3D03E",validator:D,onChange:s=>{e("other"),l("other"),p(s),I()},isDisabled:v==="pantone"},{type:"custom",label:a("Foreground colour"),component:t.jsx(k,{selections:$,defaultValue:g,onChange:s=>{e("other"),l("other"),C(s)}})}],V=d&&r&&o&&g&&D(o),U=()=>{if(V){const s="".concat(d," - ").concat(r);i==null||i([d,r,o,g],s)}},W=s=>{e(s[0]),l(s[1]),p(s[2]),C(s[3]),I()};return t.jsxs(t.Fragment,{children:[t.jsxs(X,{sx:Ce,children:[t.jsx(O,{name:a("Example"),fg:g,bg:o}),t.jsxs(T,{children:[t.jsx(de,{hidden:!0}),t.jsx(w,{fields:z}),t.jsx(w,{fields:N})]}),t.jsxs("section",{children:[t.jsxs(ee,{children:[t.jsx(Y,{as:"h5",size:"xs",children:a("Recently used")}),t.jsx(A,{variant:"ghost",size:"xs",onClick:h,children:a("Clear")})]}),t.jsx(Z,{children:x.map(({theme:s,displayName:E})=>t.jsx(q,{children:t.jsx(J,{size:"xs","aria-label":a("Apply"),title:E,mt:"0.45px",color:s[3],bg:s[2],icon:t.jsx(ie,{}),onClick:()=>W(s)})},s.join("-")))})]})]}),t.jsx(K,{}),t.jsxs(Q,{p:2,justifyContent:"flex-end",children:[t.jsx(A,{size:"sm",onClick:f,children:a("Cancel")}),t.jsx(A,{size:"sm",colorScheme:"primary",onClick:U,isDisabled:!V,children:a("Confirm")})]})]})}const he="rmg-palette-bridge--";function Se(){const[u]=re(),n=u.get("parentId"),c=u.get("parentComponent"),i=te(),{isDataLoading:f}=R(o=>o.app),[h,a]=m.useState(),[x,j]=m.useState(),d=m.useRef();m.useEffect(()=>{const o=new BroadcastChannel(he+n);return d.current=o,P.event(S.APP_CLIP_VIEW_OPENED,{parentComponent:c}),o.onmessage=p=>{const{event:g,data:C}=p.data;console.log("[".concat(o.name,"] Received event from parent component:"),g),g==="OPEN"&&(a(crypto.randomUUID()),j(C))},console.log("[".concat(o.name,"] App clip connection established, parentComponent=").concat(c)),o.postMessage({event:"LOADED"}),()=>{o.close()}},[]);const e=(o,p)=>{var g,C;console.log("[".concat((g=d.current)==null?void 0:g.name,"] Emitting SELECT event, theme:"),o),(C=d.current)==null||C.postMessage({event:"SELECT",data:o}),i(se({theme:o,displayName:p})),P.event(S.APP_CLIP_VIEW_SELECT,{parentComponent:c,theme:o})},r=()=>{var o,p;console.log("[".concat((o=d.current)==null?void 0:o.name,"] Emitting CLOSE event")),(p=d.current)==null||p.postMessage({event:"CLOSE"}),P.event(S.APP_CLIP_VIEW_CLOSED,{parentComponent:c})},l=()=>{i(ae()),P.event(S.CLEAR_HISTORY,{})};return t.jsxs(ne,{children:[f&&t.jsx(oe,{isIndeterminate:!0}),t.jsx(fe,{defaultTheme:x,sessionId:h,onSubmit:e,onClose:r,onClearHistory:l})]})}export{Se as default};
