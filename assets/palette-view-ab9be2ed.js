import{X as j,h as w,j as t,B as v,_ as h,f as b,H as A}from"./chakra-6ce25592.js";import{u as N,a as x,c as E,s as M,R as T,r as l,E as y,b as k,M as D,d as B,e as H,g as P,p as S,f as I}from"./index-e710754c.js";import{u as C,n as R,r as f}from"./react-af516715.js";import{R as L}from"./rmg-fields-b39a251e.js";import{u as g,M as z}from"./index.esm-fb9570ed.js";import{m as G}from"./ag-grid-089468c7.js";import{u as F}from"./use-palette-6b4556fd.js";var W=function(a){var r=a.children,o=j().colorMode,i=w("RmgAgGrid");return t.jsx(v,{className:o==="light"?"ag-theme-alpine":"ag-theme-alpine-dark",sx:i,children:r})};function _(){const{t:a,i18n:r}=C(),o=g(),i=N(),n=R(),d=x(s=>s.app.selectedCountry),u=E.map(s=>[s.id,o(s.name)]).sort((s,e)=>s[1].localeCompare(e[1],r.languages[0])).reduce((s,e)=>e[0]==="UN"?s:{...s,[e[0]]:e[1]},{"":a("Please select...")}),m=[{type:"select",label:a("Country/Region"),value:d,options:u,disabledOptions:[""],onChange:s=>i(M(s))}],p=()=>{l.isStandaloneWindow()?n("/new"):l.openApp("rmg-palette-upload"),l.event(y.ADD_CITY,{})};return t.jsxs(T,{children:[t.jsx(L,{fields:m}),t.jsx(h,{ml:"auto",children:t.jsx(b,{variant:"solid",size:"sm",colorScheme:"primary",onClick:p,children:a("Add a city")})})]})}function O(a){const{city:r}=a,o=F(r),i=g();return t.jsx(h,{flexWrap:"wrap",sx:{"& .chakra-badge":{mb:1}},children:o.map(n=>t.jsx(k,{name:i(n.name),fg:n.fg||D.white,bg:n.colour},n.id))})}function V(){const{t:a,i18n:r}=C(),o=g(),i=B(),n=R(),d=x(e=>e.app.selectedCountry),u=H.filter(e=>e.country===d),m=f.useMemo(()=>[{headerName:a("City"),field:"name",valueFormatter:({value:e})=>o(e),comparator:(e,c)=>o(e).localeCompare(o(c),r.languages[0]),sortable:!0,sort:"asc",wrapText:!0},{headerName:a("Lines"),field:"id",cellRenderer:({value:e})=>t.jsx(O,{city:e}),flex:1,autoHeight:!0,resizable:!1},{headerName:a("Action"),field:"id",cellRenderer:({value:e})=>t.jsx(A,{size:"xs","aria-label":a("Edit city"),title:a("Edit city"),icon:t.jsx(z,{}),onClick:()=>s(e)}),resizable:!1,width:72}],[r.language]),p=f.useMemo(()=>({resizable:!0}),[]),s=async e=>{if(l.isStandaloneWindow()){const c=await P(e);c&&(i(S(c)),n("/new"))}else l.closeApp("rmg-palette-upload"),setTimeout(()=>{l.openApp("rmg-palette-upload","/rmg-palette/#/new?city="+e)},200);l.event(y.EDIT_CITY,{city:e})};return t.jsx(W,{children:t.jsx(G.AgGridReact,{rowData:u,columnDefs:m,defaultColDef:p,getRowId:({data:e})=>e.id,headerHeight:36,rowHeight:36,suppressCellFocus:!0,suppressRowVirtualisation:!0,debug:!1})})}function Z(){return t.jsxs(I,{children:[t.jsx(_,{}),t.jsx(V,{})]})}export{Z as default};
